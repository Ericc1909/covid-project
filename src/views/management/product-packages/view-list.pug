//- extends ../../templates/management.template.pug
//- include ../../mixins/no-result.mixin.pug

//- block addStyle
//-   link(rel="stylesheet", href="/vendors/selectize/selectize.min.css")
//-   link(rel="stylesheet", href="/css/management/product-package-list.css")

//- block addContent
//-   .p-4.flex-grow-1
//-     .search.d-flex.mb-4
//-       input#searchInput.field.bg-white(type="text", placeholder="Nhập tên gói nhu yếu phẩm")
//-       button#searchBtn.btn.btn-info #[i.bi.bi-search]

//-     if search
//-       h5.my-3.text-info Kết quả tìm kiếm cho: #[b.mx-3= search] #[a(href=`/management/product-packages/list?page=${currentPage}`) #[i.bi.bi-x-square-fill.text-danger.cur-pointer#destroySearch]]

//-     if packages && packages.length > 0
//-       table.table.table-striped.table-light.table-bordered.w-100
//-         thead.thead-dark
//-           tr
//-             th(scope="col")
//-               .has-icon #[span Tên gói] #[i.bi.sort-icon(data-sort="productPackageName")]
//-             th(scope="col") Giới hạn SL sản phẩm
//-             th(scope="col") Giới hạn SL gói/ngày
//-             th(scope="col") Giới hạn SL gói/tuần
//-             th(scope="col") Giới hạn SL gói/tháng
//-             th(scope="col") Hành động
//-         tbody
//-           each p in packages
//-             tr
//-               td= p.productPackageName
//-               td= p.limitedProducts
//-               td= p.limitedInDay
//-               td= p.limitedInWeek
//-               td= p.limitedInMonth
//-               td.text-center
//-                 i.mgmt-icon.edit-icon.bi.bi-pencil-fill.px-2(data-productPackageId=p.productPackageId ,data-productPackageName=p.productPackageName, data-limitedProducts=p.limitedProducts, data-limitedInDay=p.limitedInDay, data-limitedInWeek=p.limitedInWeek, data-limitedInMonth=p.limitedInMonth)
//-                 i.mgmt-icon.info-icon.bi.bi-info-circle-fill.px-2(type="button", data-toggle="modal", data-target="#packageModal", data-whatever="#idPackage", data-uuid=p.productPackageId)
//-       #pagination
//-     else
//-       +noResult('w-80', '/management/product-packages/list')

//-     .modal.fade#packageModal(tabindex="-1", aria-labelledby="packageModalLabel", aria-hidden="true")
//-       .modal-dialog.modal-dialog-centered.modal-dialog-scrollable.m-0-auto
//-         .modal-content
//-           .modal-header.bg-info
//-             h5.modal-title.text-light.text-capitalize Chi tiết gói nhu yếu phẩm
//-             button.close(type="button", data-dismiss="modal", aria-label="Close")
//-               span.text-light(aria-hidden="true") ×
//-           .modal-body
//-             #loading.flex-center.py-4.d-none
//-               .spinner-border.text-info(role="status")
//-                 span.sr-only Đang tải dữ liệu ...
//-             #packageModalBody
//-           .modal-footer
//-             button.btn.btn-secondary(type="button", data-dismiss="modal") Đóng

//-     .modal.fade#editModal
//-       .modal-dialog.modal-dialog-centered.modal-dialog-scrollable.m-0-auto
//-         .modal-content
//-           .modal-header.bg-warning
//-             h5.modal-title.text-capitalize Cập nhật gói nhu yếu phẩm
//-             button.close(type="button", data-dismiss="modal", aria-label="Close")
//-               span(aria-hidden="true") ×
//-           .modal-body(style="padding:4rem 2rem")
//-             //- #editModalBody
//-               //- .spinner-border.text-info(role="status")
//-               //-   span.sr-only Đang tải dữ liệu ...
//-             #editModalBody
//-               label(for="#productPackageName").text-gray.font-weight-bold Tên gói #[span#currentPackageName.font-weight-normal]
//-               input#newPackageName.form-control(type="text", maxLength="100")
//-               label(for="#limitedProducts").text-gray.font-weight-bold Giới hạn SL sản phẩm #[span#currentLP.font-weight-normal]
//-               input#newLP.form-control(type="number", min="1", max="1000")
//-               label(for="#limitedInDay").text-gray.font-weight-bold Giới hạn SL gói/ngày #[span#currentLID.font-weight-normal]
//-               input#newLID.form-control(type="number", min="1", max="1000")
//-               label(for="#limitedInWeek").text-gray.font-weight-bold Giới hạn SL gói/tuần #[span#currentLIW.font-weight-normal]
//-               input#newLIW.form-control(type="number", min="1",max="1000")
//-               label(for="#limitedInMonth").text-gray.font-weight-bold Giới hạn số lượng gói/tháng #[span#currentLIM.font-weight-normal]
//-               input#newLIM.form-control(type="number", min="1", max="1000")
//-           .modal-footer
//-             button.btn.btn-secondary(type="button", data-dismiss="modal") Đóng
//-             button#updateBtn.btn.btn-warning(type="button") Cập nhật

//-   .toast-msg#toastMsg
//- block addScript
//-   script.
//-     const pageSize = parseInt("#{pageSize}");
//-     const total = parseInt("#{total}");
//-     const currentPage = parseInt("#{currentPage}");
//-     const sortListRaw = "#{sortList}";
//-     const sortList = sortListRaw.length > 0 ? sortListRaw.split(',') : [];
//-     const search = "#{search}";

//-   script(src="/vendors/selectize/selectize.min.js")
//-   script(src="/vendors/pagination.min.js")
//-   script(src="/js/management/product-package-list.js")


extends ../../templates/management.template.pug
include ../../mixins/navbar.mixin.pug
include ../../mixins/footer.mixin.pug
include ../../mixins/package-card.mixin.pug
include ../../mixins/scroll-top.mixin.pug
include ../../mixins/no-result.mixin.pug

block title
  title Covid Project | Gói nhu yếu phẩm

block append style
  link(rel="stylesheet", href="/css/user/package-card.css")
  link(rel="stylesheet", href="/css/user/home.css")

block addContent
  .toast-msg#toastMsg


  .p-4.flex-grow-1
    .search.d-flex.mb-4
      input#search.field(type="text", placeholder="Nhập tên sản phẩm cần tìm")
      button#searchBtn.btn.btn-info #[i.bi.bi-search]
    if searchKeyword
      h5.my-3.text-info Kết quả tìm kiếm cho: #[b.mx-3= searchKeyword] #[i.bi.bi-x-square-fill.text-danger.cur-pointer#destroySearch]

    .d-flex.flex-wrap.my-4.sort-filter.justify-content-center
      mixin renderOption(name, value, selected)
        if value == selected
          option(value=value, selected="selected")= name
        else
          option(value=value)= name

      .mb-3.sort
        label.d-block.pl-2.text-gray Sắp xếp theo giá
        select#sortByPrice.field
          +renderOption("Không sắp xếp", -1, sortByPrice)
          +renderOption("Giảm dần", 0, sortByPrice)
          +renderOption("Tăng dần", 1, sortByPrice)

      .mb-3.mx-3.mx-lg-5.sort
        label.d-block.pl-2.text-gray Sắp xếp tên
        select#sortByName.field
          +renderOption("Không sắp xếp", -1, sortByName)
          +renderOption("Giảm dần", 0, sortByName)
          +renderOption("Tăng dần", 1, sortByName)

      .filter
        label.pl-2.text-gray Lọc theo giá
        .d-flex.align-items-center
          input#priceFrom.field(type="number", min="0", max="1000000000", placeholder="Thấp nhất", value=priceFrom||"")
          b.mx-2 -
          input#priceTo.field(type="number", min="0", max="1000000000", placeholder="Cao nhất", value=priceTo||"")
          button#filterBtn.btn.btn-success.ml-2 Lọc
          button.btn.btn-danger.ml-2(style="border-radius:8px;height:40px") #[a.text-light(href="/management/product-packages/list") Đặt lại]

    if packages && packages.length > 0
      .product-list#packageList
        each productPackage in packages
          - const { productPackageId, productPackageName, thumbnail, products, totalPrice } = productPackage;
          +packageCard(
          productPackageId,
          productPackageName,
          thumbnail,
          helpers.formatCurrency(totalPrice),
          products
          )
    else
      +noResult('', '/management/product-packages/list')

    if packages && packages.length > 0
      .mt-5.flex-center.d-none#loading
        .spinner-border.mr-3(role="status")
          span.sr-only Đang tải dữ liệu ...
        b Đang tải dữ liệu ...
      #viewMore.view-more.mt-5 Xem thêm gói sản phẩm #[i.bi.bi-chevron-double-down]


block append script
  script(src="/js/scroll-top.js")
  script(src="/js/helpers/utils.js")
  script(src="/js/helpers/cart.js")
  script.
    const searchKeyword = "#{searchKeyword}";
  script(src="/js/user/search.js")
  //- script(src="/js/management/product-package-list.js")
